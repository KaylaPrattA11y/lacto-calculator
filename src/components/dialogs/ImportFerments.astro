---
import Dialog from "../Dialog.astro";
---

<Dialog id="importFermentsDialog" heading="Import ferments">
  <form 
    id="importFermentsForm" 
    method="dialog">
    <p><kay-icon class="carbon:warning" aria-hidden="true"></kay-icon> Importing ferment data will permanently replace the ferment data in your local storage. <em>This action is irreversible.</em></p>
    <p>Consider first exporting your current ferment data.</p>

    <label for="importFermentFile">Import ferments (.JSON)</label>
    <input type="file" accept=".json" id="importFermentFile" name="importFermentFile" />

    <div class="level">
      <div>
        <h3 id="yourFileText" hidden>Import this file?</h3>
        <p id="errorMessage" hidden>Invalid import data. Please try another file.</p>
      </div>
      <div>
        <button type="submit" class="btn-primary" aria-haspopup="dialog" aria-controls="importFermentsDialog">
          <kay-icon class="carbon:document-import" aria-hidden="true"></kay-icon>
          Import
        </button>
        <button type="button" class="btn-default" aria-haspopup="dialog" aria-controls="importFermentsDialog">Cancel</button>
      </div>
    </div>
    <ol id="fileList" hidden></ol>

  </form>
</Dialog>

<style>
  :where(label, output) {
    display: block;
  }
  label {
    margin-block-end: 0.25rem;
  }
  a {
    display: inline-block;
    margin-block-end: 1rem;
  }
  .level {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 1rem;
  }
  button {
    display: inline-block;
  }
  input[type="file" i]::-webkit-file-upload-button {
    border: 0;
    border-radius: 0.5rem;
    padding: 0.5rem 1rem;
		color: var(--text-color);
		background: var(--calc-output-background-color);
    cursor: pointer;
		text-decoration: none;
  }
  ol {
    position: relative;
    padding: 0;
  }
  ol:not([hidden]) {
    display: grid;
    gap: 1rem;
    border: 1px solid var(--border-color);
    padding: 1rem;
  }
  ol:empty::after {
    content: "Warning: No data found."
  }
  ol::before {
    content: attr(data-length) " ferments found.";
    position: absolute;
    inset: -1.5rem auto auto 0;
  }
  ol[data-length="1"]::before {
    content: attr(data-length) " ferment found.";
  }
</style>
